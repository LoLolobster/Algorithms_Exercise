# 牛顿迭代法



## 自然语言描述

​	牛顿迭代法主要是为了求解函数的根。对于函数图像，在其上任取一点做切线，得到切线与x轴的交点。过此交点作x轴的垂线与函数图像相交于另一点，然后再取切线不断重复此过程。最后切线与x轴的交点将收敛为函数的根。



## Java语言描述

> 这里主要是计算平方根。

```java
public static double sqrt(doouble c){
    if(c<0) return Double.NaN;
    double err = 1e-15;
    double t = c;
    while (Math.abs(t-c/t) > err * t)
        t = (c/t + t) /2.0;
    return t;
}
```

那么上面的和自然语言看起来完全不同的Java语言是怎么来执行牛顿迭代法的呢？

我们先构造这样一条曲线：$f(x)=x^2-c$；

![img](http://www.matrix67.com/blogimage/200711241.gif)

设我们第一次在函数上取的点为 $(x_0,f(x_0))$ ;

那么切线就是 $g(x)=f'(x_0)(x-x_0)+f(x_0)$，与横轴的交点为 $x_0-\frac{f(x_0)}{f'(x_0)}=x_0-\frac{x_0^2-c}{2x_0}$  ;

* 我们就令这个第一次迭代得到的横坐标为 $x_1$，那么就有 $x_1=(\frac{c}{x_0}+x_0)/2$ ；

这样，以后每次迭代都有上式所述关系，并且迭代最终会收敛到平方根的位置；

* 那我们怎么判断是否收敛呢？

那就是取一个很小的值 $(1e-15)*x_n$，如果两次迭代结果的差值在这个范围之内，即

$x_n-(\frac{c}{x_n}+x_n)/2的绝对值<err*x_n$（这里我们忽略$/2$），就可以认为结果收敛了；

综上，我们通过：

1. 赋初值`double t = c;`
2. 迭代条件`Math.abs(t-c/t) > err * t`;
3. 以及迭代体`t= (c/t + t) / 2/0;`

完成了牛顿迭代法的Java表述。



