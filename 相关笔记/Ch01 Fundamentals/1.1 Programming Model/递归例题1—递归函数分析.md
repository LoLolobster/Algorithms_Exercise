# 递归例题1

> 此题为原书P34,1.1.18；
>
> 请看以下递归函数：
>
> ```java
> public static int mystery(int a, int b){
>     if(b==0)	return 0;
>     if(b % 2 == 0)	return mystery(a+a, b/2);
>     return mystery(a+a, b/2) + a;
> }
> ```
>
> 给定正整数`a,b`，`mystery(a, b)`计算的结果是什么？将代码中的`+`替换为`*`并将`return 0`改为`return 1`，然后回答同样的问题。

拿到这种递归问题，怎么办？

* 第一步，看输出。

  ​	首先，这里我们有三种返回值：`0`、`mystery(a+a, b/2)`、`mystery(a+a, b/2) + a`。那么很明显，最终的返回值是由`mystery(a+a, b/2)`和`a`这两个基本表达式加和得来的。

  ​	进一步思考，`mystery(a+a, b/2)`本身是没有什么了不起的，它的值（包括它的递归子函数的值）还是要靠`a`来决定。所以这里的问题就很清晰：整个递归函数到底需要加多少次`a`？

* 第二步，看终止条件。

  ​	显然，每次加`a`，都是在`b`为奇数（前提是正整数）的情况下进行的。因此，问题就转换为在递归过程中，`b`奇数了多少次。

* 第三步，看递归子函数；

  我们观察到，在递归子函数中，`b`都是除以2之后再传入的。再结合终止条件，`b`只要不为零时，就一直被除2。那也就是说，在`b`不停地除2直到为零的过程中，b奇数了多少次。这个时候，我们就该联想到二进制了。

  > 我们假设b = 13 = 1101。
  >
  > 在除2即右移过程中，每次最右边一位为1的情况，就是b为奇数的情况。

* 这样我们终于明白，加`a`的次数就是`b`的二进制表示中1的个数。

但是问题还没有解决，我每次加的这个`a`，它的值到底是多少？

稍加观察我们就能发现，随着`b/2`，`a`每次都`*2`。也就是说，在`b`的二进制码中，第`k`位是1，这个时候的`a`就是原始值$*2^k$，我们就得把它加上。再观察一下，这个加总的和不就是`a`的原始值$*$`b`吗！

所以实际上，这个递归函数就是个乘法。



**Pt2**

当然这个题目还有第二部分，但是到这已经破案了。

改为乘号之后，我们要求的就是一个累乘。同样，在b的二进制码中，第k位是1，我们就乘上一个$a^k$。这样，不过就是把上面的累加运算放到了指数上，即$a^b$。 

